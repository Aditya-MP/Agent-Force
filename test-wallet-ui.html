<!DOCTYPE html>
<html>
<head>
    <title>Real-Time Wallet Scanner</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 50px auto; padding: 20px; }
        .container { background: #f5f5f5; padding: 30px; border-radius: 10px; }
        input { width: 100%; padding: 15px; font-size: 16px; border: 2px solid #ddd; border-radius: 5px; margin: 10px 0; }
        button { background: #007bff; color: white; padding: 15px 30px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        button:hover { background: #0056b3; }
        .result { background: white; padding: 20px; margin: 20px 0; border-radius: 5px; border-left: 4px solid #007bff; }
        .error { border-left-color: #dc3545; background: #f8d7da; }
        .loading { color: #007bff; font-weight: bold; }
        .balance { font-size: 24px; color: #28a745; font-weight: bold; }
        .timestamp { color: #666; font-size: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Real-Time Cardano Wallet Scanner</h1>
        <p>Enter any Cardano wallet address to scan balance in real-time (no data stored)</p>
        
        <input type="text" id="walletAddress" placeholder="Enter Cardano wallet address (addr_test1...)" 
               value="addr_test1qpw0djgj0x59ngrjvqthn7enhvruxnsavsw5th63la3mjel3tkc974sr23jmlzgq5zda4gtv8k9cy38756r9y3qgmkqqjz6aa7">
        
        <button onclick="scanWallet()">üîç Scan Wallet (Real-Time)</button>
        <button onclick="quickBalance()">‚ö° Quick Balance Check</button>
        
        <div id="result"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3001/api';
        
        async function scanWallet() {
            const address = document.getElementById('walletAddress').value.trim();
            const resultDiv = document.getElementById('result');
            
            if (!address) {
                resultDiv.innerHTML = '<div class="result error">Please enter a wallet address</div>';
                return;
            }
            
            resultDiv.innerHTML = '<div class="result loading">üîÑ Scanning wallet in real-time...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/wallet/${address}`);
                const data = await response.json();
                
                if (data.error) {
                    resultDiv.innerHTML = `
                        <div class="result error">
                            <h3>‚ùå Scan Failed</h3>
                            <p><strong>Error:</strong> ${data.error}</p>
                            <p class="timestamp">Scan time: ${data.scanTime || new Date().toISOString()}</p>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="result">
                            <h3>‚úÖ Wallet Scan Complete</h3>
                            <div class="balance">üí∞ ${data.balance} ADA</div>
                            <p><strong>UTXOs:</strong> ${data.utxoCount}</p>
                            <p><strong>Native Tokens:</strong> ${data.nativeTokens?.length || 0}</p>
                            <p><strong>Staking:</strong> ${data.isStaking ? '‚úÖ Active' : '‚ùå Not staking'}</p>
                            <p><strong>Delegated Pool:</strong> ${data.delegatedPool}</p>
                            <p><strong>Network:</strong> ${data.network}</p>
                            <p class="timestamp">Real-time scan: ${data.scanTime}</p>
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="result error">
                        <h3>‚ùå Connection Failed</h3>
                        <p>Could not connect to backend server</p>
                        <p>Make sure backend is running on port 3001</p>
                    </div>
                `;
            }
        }
        
        async function quickBalance() {
            const address = document.getElementById('walletAddress').value.trim();
            const resultDiv = document.getElementById('result');
            
            if (!address) {
                resultDiv.innerHTML = '<div class="result error">Please enter a wallet address</div>';
                return;
            }
            
            resultDiv.innerHTML = '<div class="result loading">‚ö° Quick balance check...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/balance/${address}`);
                const data = await response.json();
                
                if (data.error) {
                    resultDiv.innerHTML = `
                        <div class="result error">
                            <h3>‚ùå Balance Check Failed</h3>
                            <p><strong>Error:</strong> ${data.error}</p>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="result">
                            <h3>‚ö° Quick Balance</h3>
                            <div class="balance">üí∞ ${data.balance} ADA</div>
                            <p><strong>UTXOs:</strong> ${data.utxoCount}</p>
                            <p class="timestamp">Real-time: ${data.timestamp}</p>
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="result error">
                        <h3>‚ùå Connection Failed</h3>
                        <p>Could not connect to backend server</p>
                    </div>
                `;
            }
        }
        
        // Allow Enter key to scan
        document.getElementById('walletAddress').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                scanWallet();
            }
        });
    </script>
</body>
</html>